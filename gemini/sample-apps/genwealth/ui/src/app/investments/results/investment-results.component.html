<div *ngIf="data">
    <app-sql-statement [query]="query">
        @if(data.length == 0) {
            <div class="no-results">No results were found</div>
        } @else {
            See Query
        }
    </app-sql-statement>

    <div *ngIf="generatedQuery">
        <app-sql-statement [query]="generatedQuery">
            See Generated SQL (AlloyDB "Magic")
        </app-sql-statement>
    </div>

    @if(data[0].hasOwnProperty('ticker')) {
    <div class="investment-container">
        <mat-card *ngFor="let investment of data" class="investment-card">
            <mat-card-title>{{investment.ticker}}</mat-card-title>
            <mat-card-subtitle *ngIf="investment.rating">
                <div>
                    Rating: <span class="rating">{{investment.rating}}</span>
                </div>
            </mat-card-subtitle>
            <div innerHtml="{{investment.analysis | textToHtml}}"></div>
        </mat-card>
    </div>
    } @else {
        <mat-table #table [dataSource]="data">
            <tr>
                @for (col of getColumns(data); track col; let i = $index) {
                        r   <th> {{ col }} </th>
                }
            </tr>
        </mat-table>
    }
</div>